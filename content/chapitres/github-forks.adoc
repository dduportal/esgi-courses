[{invert}]
= GitHub Forks

== ğŸ“ Exercice: CrÃ©ez un fork

* Nous allons vous faire forker vos dÃ©pÃ´ts respectifs
* Trouvez vous un binÃ´me dans le groupe et Ã©changez vos URL de dÃ©pÃ´ts
* Depuis la page du dÃ©pÃ´t de votre binÃ´me, cliquez en haut Ã  droite sur le bouton **Fork**.

image:fork.png[]

[{invert}]
== !

ğŸ“ Ã€ vous de jouer : dans le dÃ©pÃ´t de votre binÃ´me, vous allez ajouter un Ã©tape de "lint"

== ğŸ“ Exercice: Contribuez au projet de votre binÃ´me (1/5)

PremiÃ¨re Ã©tape: on clone le fork dans son environnement de dÃ©veloppement

[source,bash]
----
cd /workspace/

# Clonez votre fork
git clone <url_de_votre_fork>

# Se placer dans le fork
cd <nom_du_fork>

# CrÃ©ez votre feature branch
git switch --create feat/hadolint
----

== ğŸ“ Exercice: Contribuez au projet de votre binÃ´me (2/5)

Maintenant voici la liste des choses Ã  faire:

* Ajoutez une Ã©tape de "lint" dans le workflow, avant de fabriquer l'image
** La ligne de commande https://github.com/hadolint/hadolint[`hadolint`] est prÃ©-installÃ©e dans votre GitPod
** https://github.com/hadolint/hadolint-action[GitHub action hadolint]

* Corrigez /ignorez les erreurs du lint afin d'avoir un build qui passe

== ğŸ“ Exercice: Contribuez au projet de votre binÃ´me (3/5)

Pour tester votre changement :

[source, bash]
----
hadolint ./Dockerfile
----

== ğŸ“ Exercice: Contribuez au projet de votre binÃ´me (4/5)

Une fois que vous Ãªtes satisfaits de votre changement il vous faut maintenant crÃ©er un commit et pousser votre nouvelle branche sur votre fork.

== ğŸ“ Exercice: Contribuez au projet de votre binÃ´me (5/5)

DerniÃ¨re Ã©tape: ouvrir une pull request!

* Rendez vous sur la page de votre projet
* SÃ©lectionnez votre branche dans le menu dÃ©roulant "branches"  en haut a gauche.
* Cliquez ensuite sur le bouton ouvrir une pull request
* Remplissez le contenu de votre PR (titre, description, labels) et validez.

image:pr.png[]

== La procÃ©dure de Pull Request

*Objectif* : Valider les changements d'un contributeur

* Technique : est-ce que Ã§a marche ? est-ce maintenable ?
* Fonctionnel : est-ce que le code fait ce que l'on veux ?
* Humain : Propager la connaissance par la revue de code.
* MÃ©thode : Tracer les changements.

== Revue de code ?

* Validation par un ou plusieurs pairs (technique et non technique) des changements
* Relecture depuis github (ou depuis le poste du dÃ©veloppeur)
* Chaque relecteur Ã©met des commentaires // suggestions de changement
* Quand un relecteur est satisfait d'un changement, il l'approuve

== !

* La revue de code est un **exercice difficile** et **potentiellement frustrant** pour les deux parties.
** Comme sur Twitter, on est bien Ã  l'abri derriÃ¨re son Ã©cran ;=)
* En tant que contributeur, **soyez respectueux** de vos relecteurs : votre changement peut Ãªtre refusÃ© et c'est quelque chose de normal.
* En tant que relecteur, **soyez respectueux** du travail effectuÃ©, mÃªme si celui ci comporte des erreurs ou ne correspond pas Ã  vos attentes.

ğŸ’¡ Astuce: link:https://github.com/franckverrot/clamav-client/pull/12#discussion_r526222319[Proposez des solutions] plutÃ´t que simplement pointer les problÃ¨mes.

== ğŸ“ Exercice: Relisez votre PR reÃ§ue !

* Vous devriez avoir reÃ§u une PR de votre binÃ´me :-)
* Relisez le changement de la PR
* Effectuez quelques commentaires (bonus: utilisez la suggestion de changements), si c'est nÃ©cessaire
* Si elle vous convient, approuvez la!
* En revanche ne la "mergez" pas, car il manque quelque chose...

== Validation automatisÃ©e

**Objectif**: Valider que le changement n'introduit pas de rÃ©gressions dans le projet

* A chaque fois qu'un nouveau commit est crÃ©Ã© dans une PR, une succession de validations ("checks") sont dÃ©clenchÃ©s par GitHub
* Effectue des vÃ©rifications automatisÃ©es sur un commit de merge entre votre branche cible et la branche de PR

== Quelques exemples

* Analyse syntaxique du code (lint), pour dÃ©tecter les erreurs potentielles ou les violations du guide de style
* Compilation du projet
* Execution des tests automatisÃ©s du projet
* DÃ©ploiement du projet dans un environnement de test...

Ces "checks" peuvent Ãªtres exÃ©cutÃ©s par votre moteur de CI ou des outils externes.

== ğŸ“ Exercice: DÃ©clencher un Workflow de CI sur une PR

* Votre PR n'a pas dÃ©clenchÃ© le workflow de CI de votre binÃ´me ğŸ¤”
* Il faut modifier votre workflow pour qu'il se dÃ©clenche aussi sur une PR
* "Une chose Ã  la fois" : faites une PR dÃ©diÃ©e au dÃ©clenchement, puis mettez Ã  jour la PR initial
* La link:https://docs.github.com/en/actions/learn-github-actions/events-that-trigger-workflows[documentation] se trouve par ici

== Checkpoint ğŸ¯

*RÃ¨gle d'or*: Si le CI est rouge, on ne merge pas la pull request !

[.small]
MÃªme si le linter "ilÃ©con", mÃªme si on a la flemme et "sÃ©panou" qui avons cassÃ© le CI.
